<%-include("header")-%>


<div class="container">
    <div id="main-content" class="card text-bg-dark mb-3">
        <img
        id="berry"
        src="/blockberry-logo-white.png"
        class="d-inline-block align-text-top"
      />
      </a>
      <div class="card-body">
        <p class="card-text">Welcome, please sign in.</p>
        <form method="post" action="/login">
          

            <div class="mb-3 input-row" id="email-icon">
                <i class="bi bi-person"></i>  
              <input id="inputs a" type="email" class="form-control" id="inputEmail" placeholder="Email" name="email">
            </div>

            <div class="email error"></div>
            <div class="mb-3 input-row">
              <i class="bi bi-lock"></i>
              <input id="inputs b"type="password" class="form-control" id="inputPassword" placeholder="Password" name="password">
            </div>  
            <div class="password error"></div>
            <div class="buttons">
              <button class="btn btn-primary" id="main-action" type="submit">Login</button>
              <a class="signup-link" href="/signup">Create your Account</a>
            </div>  
          </form>
          <!-- <h5 class="guest">Explore website with a guest account</h5> -->
      </div>
    </div>
</div>

<script>
  //LISTEN FOR FORM SUBMIT
  const form = document.querySelector("form");
  const emailError = document.querySelector(".email.error");
  const passwordError = document.querySelector(".password.error");

  form.addEventListener("submit", async (e) => {
  
    e.preventDefault();


    //RESET ERRORS
    emailError.textContent = "";
    passwordError.textContent = "";


    //GET VALUES
    const name = form.name.value;
    const email = form.email.value;
    const password = form.password.value;
    

    try {
      const res = await fetch("/login", {
        method: "POST",
        body: JSON.stringify({ email, password }),
        headers: {"Content-Type" : "application/json"}
      });
      const data = await res.json();


      if (data.errors){
        emailError.textContent = data.errors.email;
        passwordError.textContent = data.errors.password;
      }
      if (data.user) {
        location.assign("/");
      }  
    } catch (err) {
      console.log(err);
    };

  });

</script>

<%-include("footer")-%>